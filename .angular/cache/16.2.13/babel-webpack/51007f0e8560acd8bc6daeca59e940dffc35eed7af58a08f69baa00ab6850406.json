{"ast":null,"code":"import _asyncToGenerator from \"C:/Users/zeina/frontend-gestioncle/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { __decorate } from \"tslib\";\nimport { Component } from '@angular/core';\nimport { Remise } from '../remise';\nimport { map, switchMap } from 'rxjs/operators';\nimport { of } from 'rxjs';\nlet RemiseEditComponent = class RemiseEditComponent {\n  constructor(route, router, remiseService, lotService) {\n    this.route = route;\n    this.router = router;\n    this.remiseService = remiseService;\n    this.lotService = lotService;\n    this.feedback = {};\n    this.lots = [];\n  }\n  ngOnInit() {\n    this.route.params.pipe(map(p => p['id']), switchMap(id => {\n      if (id === 'new') {\n        return of(new Remise());\n      }\n      return this.remiseService.findById(id);\n    })).subscribe({\n      next: remise => {\n        this.remise = remise;\n        this.feedback = {};\n        this.loadLots();\n      },\n      error: err => {\n        this.feedback = {\n          type: 'warning',\n          message: 'Error loading'\n        };\n      }\n    });\n  }\n  loadLots() {\n    this.lotService.getList().subscribe({\n      next: data => {\n        this.lots = data;\n      },\n      error: err => {\n        console.log(err);\n      }\n    });\n  }\n  save() {\n    var _this = this;\n    console.log(this.remise);\n    this.remiseService.save(this.remise).subscribe({\n      next: remise => {\n        this.remise = remise;\n        this.feedback = {\n          type: 'success',\n          message: 'Enregistrement effectué!'\n        };\n        setTimeout( /*#__PURE__*/_asyncToGenerator(function* () {\n          yield _this.router.navigate(['/remises']);\n        }), 1000);\n      },\n      error: err => {\n        this.feedback = {\n          type: 'warning',\n          message: 'Erreur enregistrement'\n        };\n      }\n    });\n  }\n  cancel() {\n    var _this2 = this;\n    return _asyncToGenerator(function* () {\n      yield _this2.router.navigate(['/remises']);\n    })();\n  }\n};\nRemiseEditComponent = __decorate([Component({\n  selector: 'app-remise-edit',\n  templateUrl: './remise-edit.component.html'\n})], RemiseEditComponent);\nexport { RemiseEditComponent };","map":{"version":3,"names":["Component","Remise","map","switchMap","of","RemiseEditComponent","constructor","route","router","remiseService","lotService","feedback","lots","ngOnInit","params","pipe","p","id","findById","subscribe","next","remise","loadLots","error","err","type","message","getList","data","console","log","save","_this","setTimeout","_asyncToGenerator","navigate","cancel","_this2","__decorate","selector","templateUrl"],"sources":["C:\\Users\\zeina\\frontend-gestioncle\\src\\app\\remise\\remise-edit\\remise-edit.component.ts"],"sourcesContent":["import { Component, OnInit } from '@angular/core';\nimport { ActivatedRoute, Router } from '@angular/router';\nimport { RemiseService } from '../remise.service';\nimport { Remise } from '../remise';\nimport { map, switchMap } from 'rxjs/operators';\nimport { of } from 'rxjs';\nimport { LotService } from 'src/app/lot/lot.service';\n\n@Component({\n  selector: 'app-remise-edit',\n  templateUrl: './remise-edit.component.html'\n})\nexport class RemiseEditComponent implements OnInit {\n\n  id!: string;\n  remise!: Remise;\n  feedback: any = {};\n  lots: any = [];\n\n\n  constructor(\n    private route: ActivatedRoute,\n    private router: Router,\n    private remiseService: RemiseService,\n    private lotService: LotService) {\n    \n  }\n\n  ngOnInit() {\n    this\n      .route\n      .params\n      .pipe(\n        map(p => p['id']),\n        switchMap(id => {\n          if (id === 'new') { return of(new Remise()); }\n          return this.remiseService.findById(id);\n        })\n      )\n      .subscribe({\n        next: remise => {\n          this.remise = remise;\n          this.feedback = {};\n          this.loadLots();\n        },\n        \n        error: err => {\n          this.feedback = {type: 'warning', message: 'Error loading'};\n        }\n      });\n  }\n\n  loadLots(){\n    this.lotService.getList().subscribe({\n      next:(data:any)  => {\n        this.lots = data;\n      },\n      error: (err:any) => {\n      console.log (err)     }\n    });\n  }\n\n  save() {\n    console.log(this.remise);\n    this.remiseService.save(this.remise).subscribe({\n      \n      next: remise => {\n        this.remise = remise;\n      \n        this.feedback = {type: 'success', message: 'Enregistrement effectué!'};\n        setTimeout(async () => {\n          await this.router.navigate(['/remises']);\n        }, 1000);\n      },\n      error: err => {\n        this.feedback = {type: 'warning', message: 'Erreur enregistrement'};\n      }\n    });\n  }\n\n  async cancel() {\n    await this.router.navigate(['/remises']);\n  }\n}\n"],"mappings":";;AAAA,SAASA,SAAS,QAAgB,eAAe;AAGjD,SAASC,MAAM,QAAQ,WAAW;AAClC,SAASC,GAAG,EAAEC,SAAS,QAAQ,gBAAgB;AAC/C,SAASC,EAAE,QAAQ,MAAM;AAOlB,IAAMC,mBAAmB,GAAzB,MAAMA,mBAAmB;EAQ9BC,YACUC,KAAqB,EACrBC,MAAc,EACdC,aAA4B,EAC5BC,UAAsB;IAHtB,KAAAH,KAAK,GAALA,KAAK;IACL,KAAAC,MAAM,GAANA,MAAM;IACN,KAAAC,aAAa,GAAbA,aAAa;IACb,KAAAC,UAAU,GAAVA,UAAU;IARpB,KAAAC,QAAQ,GAAQ,EAAE;IAClB,KAAAC,IAAI,GAAQ,EAAE;EASd;EAEAC,QAAQA,CAAA;IACN,IAAI,CACDN,KAAK,CACLO,MAAM,CACNC,IAAI,CACHb,GAAG,CAACc,CAAC,IAAIA,CAAC,CAAC,IAAI,CAAC,CAAC,EACjBb,SAAS,CAACc,EAAE,IAAG;MACb,IAAIA,EAAE,KAAK,KAAK,EAAE;QAAE,OAAOb,EAAE,CAAC,IAAIH,MAAM,EAAE,CAAC;;MAC3C,OAAO,IAAI,CAACQ,aAAa,CAACS,QAAQ,CAACD,EAAE,CAAC;IACxC,CAAC,CAAC,CACH,CACAE,SAAS,CAAC;MACTC,IAAI,EAAEC,MAAM,IAAG;QACb,IAAI,CAACA,MAAM,GAAGA,MAAM;QACpB,IAAI,CAACV,QAAQ,GAAG,EAAE;QAClB,IAAI,CAACW,QAAQ,EAAE;MACjB,CAAC;MAEDC,KAAK,EAAEC,GAAG,IAAG;QACX,IAAI,CAACb,QAAQ,GAAG;UAACc,IAAI,EAAE,SAAS;UAAEC,OAAO,EAAE;QAAe,CAAC;MAC7D;KACD,CAAC;EACN;EAEAJ,QAAQA,CAAA;IACN,IAAI,CAACZ,UAAU,CAACiB,OAAO,EAAE,CAACR,SAAS,CAAC;MAClCC,IAAI,EAAEQ,IAAQ,IAAK;QACjB,IAAI,CAAChB,IAAI,GAAGgB,IAAI;MAClB,CAAC;MACDL,KAAK,EAAGC,GAAO,IAAI;QACnBK,OAAO,CAACC,GAAG,CAAEN,GAAG,CAAC;MAAK;KACvB,CAAC;EACJ;EAEAO,IAAIA,CAAA;IAAA,IAAAC,KAAA;IACFH,OAAO,CAACC,GAAG,CAAC,IAAI,CAACT,MAAM,CAAC;IACxB,IAAI,CAACZ,aAAa,CAACsB,IAAI,CAAC,IAAI,CAACV,MAAM,CAAC,CAACF,SAAS,CAAC;MAE7CC,IAAI,EAAEC,MAAM,IAAG;QACb,IAAI,CAACA,MAAM,GAAGA,MAAM;QAEpB,IAAI,CAACV,QAAQ,GAAG;UAACc,IAAI,EAAE,SAAS;UAAEC,OAAO,EAAE;QAA0B,CAAC;QACtEO,UAAU,eAAAC,iBAAA,CAAC,aAAW;UACpB,MAAMF,KAAI,CAACxB,MAAM,CAAC2B,QAAQ,CAAC,CAAC,UAAU,CAAC,CAAC;QAC1C,CAAC,GAAE,IAAI,CAAC;MACV,CAAC;MACDZ,KAAK,EAAEC,GAAG,IAAG;QACX,IAAI,CAACb,QAAQ,GAAG;UAACc,IAAI,EAAE,SAAS;UAAEC,OAAO,EAAE;QAAuB,CAAC;MACrE;KACD,CAAC;EACJ;EAEMU,MAAMA,CAAA;IAAA,IAAAC,MAAA;IAAA,OAAAH,iBAAA;MACV,MAAMG,MAAI,CAAC7B,MAAM,CAAC2B,QAAQ,CAAC,CAAC,UAAU,CAAC,CAAC;IAAC;EAC3C;CACD;AAvEY9B,mBAAmB,GAAAiC,UAAA,EAJ/BtC,SAAS,CAAC;EACTuC,QAAQ,EAAE,iBAAiB;EAC3BC,WAAW,EAAE;CACd,CAAC,C,EACWnC,mBAAmB,CAuE/B;SAvEYA,mBAAmB","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}